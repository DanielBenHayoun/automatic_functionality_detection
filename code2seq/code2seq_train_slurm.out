activate enviroment RE_project_1
start train...
2020-08-08 18:11:58.456957: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-08-08 18:11:58.475805: I tensorflow/core/common_runtime/process_util.cc:69] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Dictionaries loaded.
Loaded subtoken vocab. size: 47
Loaded target word vocab. size: 16
Loaded nodes vocab. size: 34
Created model
Starting training
WARNING:tensorflow:From /home/danielben/anaconda3/envs/RE_project_1/lib/python3.6/site-packages/tensorflow/python/ops/sparse_ops.py:1165: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
Training batch size:			 512
Dataset path:				 ../dataset_code2seq/data/dataset//dataset
Training file path:			 ../dataset_code2seq/data/dataset//dataset.train.c2s
Validation path:			 ../dataset_code2seq/data/dataset//dataset.val.c2s
Taking max contexts from each example:	 200
Random path sampling:			 True
Embedding size:				 128
Using BiLSTMs, each of size:		 128
Decoder size:				 320
Decoder layers:				 1
Max path lengths:			 682
Max subtokens in a token:		 5
Max target length:			 6
Embeddings dropout keep_prob:		 0.75
LSTM dropout keep_prob:			 0.5
============================================
Number of trainable params: 1736064
Initalized variables
Started reader...
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m3s
Accuracy after 1 epochs: 0.00000
After 1 epochs: Precision: 0.05263, recall: 0.33333, F1: 0.09091
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Saved after 1 epochs in: models/cpp-miner-exp1-model/model_iter1
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 2 epochs: 0.00000
After 2 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Saved after 2 epochs in: models/cpp-miner-exp1-model/model_iter2
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 3 epochs: 0.00000
After 3 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 4 epochs: 0.00000
After 4 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 5 epochs: 0.00000
After 5 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 6 epochs: 0.00000
After 6 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 7 epochs: 0.00000
After 7 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 8 epochs: 0.00000
After 8 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 9 epochs: 0.00000
After 9 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 10 epochs: 0.00000
After 10 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 11 epochs: 0.00000
After 11 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 12 epochs: 0.00000
After 12 epochs: Precision: 0.05556, recall: 0.33333, F1: 0.09524
Rouge:  {'rouge-1': {'f': 0.1333333322666667, 'p': 0.08333333333333333, 'r': 0.3333333333333333}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.08717948717939376, 'p': 0.08333333333333333, 'r': 0.3333333333333333}}
Not improved for 10 epochs, stopping training
Best scores - epoch 2: 
Precision: 0.05556, recall: 0.33333, F1: 0.09524
finished train!
