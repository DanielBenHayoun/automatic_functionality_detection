2020-09-27 07:22:01.605973: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
Dictionaries loaded.
Loaded subtoken vocab. size: 13
Loaded target word vocab. size: 7
Loaded nodes vocab. size: 11
Created model
Starting training
WARNING:tensorflow:From /home/eialper/miniconda3/envs/RE_project_1/lib/python3.6/site-packages/tensorflow/python/ops/sparse_ops.py:1165: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
Training batch size:			 512
Dataset path:				 /home/eialper/final_project/automatic_functionality_detection/test_datasets/two_func/data/dataset/dataset
Training file path:			 /home/eialper/final_project/automatic_functionality_detection/test_datasets/two_func/data/dataset/dataset.train.c2s
Validation path:			 /home/eialper/final_project/automatic_functionality_detection/test_datasets/two_func/data/dataset/dataset.train.c2s
Taking max contexts from each example:	 200
Random path sampling:			 True
Embedding size:				 128
Using BiLSTMs, each of size:		 128
Decoder size:				 320
Decoder layers:				 1
Max path lengths:			 9
Max subtokens in a token:		 5
Max target length:			 6
Embeddings dropout keep_prob:		 0.75
LSTM dropout keep_prob:			 0.5
============================================
Number of trainable params: 1724736
Initalized variables
Started reader...
SINGLE BATCH LOSS 5.814458
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m2s
Accuracy after 1 epochs: 0.00000
After 1 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
Saved after 1 epochs in: models/twofunction/model_iter1
SINGLE BATCH LOSS 5.794371
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 2 epochs: 0.00000
After 2 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.8017106
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 3 epochs: 0.00000
After 3 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.7925897
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 4 epochs: 0.00000
After 4 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.830248
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 5 epochs: 0.00000
After 5 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.8157463
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 6 epochs: 0.00000
After 6 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.7990665
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 7 epochs: 0.00000
After 7 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.849453
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 8 epochs: 0.00000
After 8 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.881199
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 9 epochs: 0.00000
After 9 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.8473473
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 10 epochs: 0.00000
After 10 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
SINGLE BATCH LOSS 5.84606
Finished 1 epochs
Done testing, epoch reached
Evaluation time: 0h0m0s
Accuracy after 11 epochs: 0.00000
After 11 epochs: Precision: 0.33333, recall: 0.25000, F1: 0.28571
Rouge:  {'rouge-1': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}, 'rouge-2': {'f': 0.0, 'p': 0.0, 'r': 0.0}, 'rouge-l': {'f': 0.33333333111111113, 'p': 0.5, 'r': 0.25}}
Not improved for 10 epochs, stopping training
Best scores - epoch 1: 
Precision: 0.33333, recall: 0.25000, F1: 0.28571
